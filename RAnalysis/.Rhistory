}
# Add lines to separate species and species names
for (i in 1:length(spbreaks)) {
lines(c(0, 1.07), c(spbreaks[i], spbreaks[i]), xpd=T, type="l", lwd=0.4)
text(1.03, (spbreaks[i] + spbreaks[i+1]) / 2, xpd=T, pos=4, cex=0.8,
labels=paste(samdat$Genus[which(duplicated(samdat$Species)==F)][i], "\n",
samdat$Species[which(duplicated(samdat$Species)==F)][i], sep=""))
}
for (i in 1:nrow(samdat)) {
text(0, i-0.5, rownames(samdat)[i], xpd=T, cex=0.7, pos=2)
}
}
par(mfrow=c(1,1), mar=c(2, 1.5, 2, 10), lwd=0.1, cex=0.7, xpd=NA)
# Plot composition of 97% within-sample OTUs colored by clade
composition(phy.f.p, col=taxcolors[factor(data.frame(tax_table(phy.f.p))[order(data.frame(tax_table(phy.f.p))$Subtype), ]$Clade, levels=c("A","C","D"))], legend=T)
tile1.1 <- read.csv("Data/Tiles1_1_905379_Jan06_Sept06.csv")
tile1.1 <- tile1.1[,c(1:2)]
tile1.2 <- read.csv("Data/Tiles1_2_905385_Sept06_Jan07.csv")
tile1.2 <- tile1.2[,c(1:2)]
tile1.3 <- read.csv("Data/Tiles1_3_905383_Jan07_Sept07.csv")
tile1.3 <- tile1.3[,c(1:2)]
tile1.4 <- read.csv("Data/Tiles1_4_905377_Sept07_Feb08.csv")
tile1.4 <- tile1.4[,c(1:2)]
Tile1 <- rbind(tile1.1, tile1.2, tile1.3, tile1.4)
tile2.1 <- read.csv("Data/Tiles2_1_905381_Jan06_Sept06.csv")
tile2.1 <- tile2.1[,c(1:2)]
tile2.2 <- read.csv("Data/Tiles2_2_905384_Jan07_Sept07.csv")
tile2.2 <- tile2.2[,c(1:2)]
Tile2 <- rbind(tile1.1, tile1.2)
temp <- cbind(Tile1$Day.Time, Tile2$Day.Time, Tile1$Temp.C, Tile2$Temp.C)
?cbind
hist(Tile1$Temp.C, xlim=c(26.5,31.5), breaks=20, main="Site 1", xlab="Temp 째C")
hist(Tile1$Temp.C, xlim=c(26.5,31.5), breaks=20, main="Site 1", xlab="Temp 째C")
View(Tile1)
par(mfrow=c(2,3), mar=c(3,3,2,2), mgp=c(1.5,0.1,0), tcl=-0.2)
hist(Tile1$Temp.C, xlim=c(26.5,31.5), breaks=20, main="Site 1", xlab="Temp 째C")
dev.off()
hist(Tile1$Temp.C, xlim=c(26.5,31.5), breaks=20, main="Site 1", xlab="Temp 째C")
View(temp)
?merge
tile1.1 <- read.csv("Data/Tiles1_1_905379_Jan06_Sept06.csv")
tile1.1 <- tile1.1[,c(1:2)]
tile1.2 <- read.csv("Data/Tiles1_2_905385_Sept06_Jan07.csv")
tile1.2 <- tile1.2[,c(1:2)]
tile1.3 <- read.csv("Data/Tiles1_3_905383_Jan07_Sept07.csv")
tile1.3 <- tile1.3[,c(1:2)]
tile1.4 <- read.csv("Data/Tiles1_4_905377_Sept07_Feb08.csv")
tile1.4 <- tile1.4[,c(1:2)]
Site.1 <- rbind(tile1.1, tile1.2, tile1.3, tile1.4)
tile2.1 <- read.csv("Data/Tiles2_1_905381_Jan06_Sept06.csv")
tile2.1 <- tile2.1[,c(1:2)]
tile2.2 <- read.csv("Data/Tiles2_2_905384_Jan07_Sept07.csv")
tile2.2 <- tile2.2[,c(1:2)]
Site.2 <- rbind(tile1.1, tile1.2)
tile3.1 <- read.csv("Data/Tiles3_1_905385_Jan06_Sept06.csv")
tile3.1 <- tile3.1[,c(1:2)]
tile3.2 <- read.csv("Data/Tiles3_2_905382_Sept06_Jan07.csv")
tile3.2 <- tile3.2[,c(1:2)]
tile3.3 <- read.csv("Data/Tiles3_3_905381_Jan07_Sept07.csv")
tile3.3 <- tile3.3[,c(1:2)]
tile3.4 <- read.csv("Data/Tiles3_4_905379_Sept07_Feb08.csv")
tile3.4 <- tile3.4[,c(1:2)]
Site.3 <- rbind(tile3.1, tile3.2, tile3.3, tile3.4)
View(Site.1)
tile1.1 <- read.csv("Data/Tiles1_905379_Jan06_Sept06.csv")
tile1.1 <- read.csv("Data/Tiles1_905377_Jan06_Sept06.csv")
tile1.4 <- read.csv("Data/Tiles1_905377_Sept07_Feb08.csv")
View(tile1.4)
tile1.1 <- read.csv("Data/Tiles1_905377_Jan06_Sept06.csv")
tile1.1 <- read.csv("Data/Tiles1_1_905379_Jan06_Sept06.csv")
tile1.1 <- tile1.1[,c(1:2)]
tile1.2 <- read.csv("Data/Tiles1_2_905385_Sept06_Jan07.csv")
tile1.2 <- tile1.2[,c(1:2)]
tile1.3 <- read.csv("Data/Tiles1_3_905383_Jan07_Sept07.csv")
tile1.3 <- tile1.3[,c(1:2)]
tile1.4 <- read.csv("Data/Tiles1_4_905377_Sept07_Feb08.csv")
tile1.4 <- tile1.4[,c(1:2)]
Site.1 <- rbind(tile1.1, tile1.2, tile1.3, tile1.4)
tile2.1 <- read.csv("Data/Tiles2_1_905381_Jan06_Sept06.csv")
tile2.1 <- tile2.1[,c(1:2)]
tile2.2 <- read.csv("Data/Tiles2_2_905384_Jan07_Sept07.csv")
tile2.2 <- tile2.2[,c(1:2)]
Site.2 <- rbind(tile1.1, tile1.2)
View(Site.1)
View(Site.2)
temp <- merge(Site.1, Site.2,  by='Date.Time', all=T) #crashes R
View(temp)
tile1.1 <- read.csv("Data/Tiles1_1_905379_Jan06_Sept06.csv")
tile1.1 <- tile1.1[,c(1:2)]
tile1.2 <- read.csv("Data/Tiles1_2_905385_Sept06_Jan07.csv")
tile1.2 <- tile1.2[,c(1:2)]
tile1.3 <- read.csv("Data/Tiles1_3_905383_Jan07_Sept07.csv")
tile1.3 <- tile1.3[,c(1:2)]
tile1.4 <- read.csv("Data/Tiles1_4_905377_Sept07_Feb08.csv")
tile1.4 <- tile1.4[,c(1:2)]
Site.1 <- rbind(tile1.1, tile1.2, tile1.3, tile1.4)
tile2.1 <- read.csv("Data/Tiles2_1_905381_Jan06_Sept06.csv")
tile2.1 <- tile2.1[,c(1:2)]
tile2.2 <- read.csv("Data/Tiles2_2_905384_Jan07_Sept07.csv")
tile2.2 <- tile2.2[,c(1:2)]
Site.2 <- rbind(tile1.1, tile1.2)
tile3.1 <- read.csv("Data/Tiles3_1_905385_Jan06_Sept06.csv")
tile3.1 <- read.csv("Data/Tiles3_1_905385_Jan06_Sept06.csv")
tile3.1 <- tile3.1[,c(1:2)]
tile3.2 <- read.csv("Data/Tiles3_2_905382_Sept06_Jan07.csv")
tile3.2 <- tile3.2[,c(1:2)]
tile3.3 <- read.csv("Data/Tiles3_3_905381_Jan07_Sept07.csv")
tile3.3 <- tile3.3[,c(1:2)]
tile3.4 <- read.csv("Data/Tiles3_4_905379_Sept07_Feb08.csv")
tile3.4 <- tile3.4[,c(1:2)]
Site.3 <- rbind(tile3.1, tile3.2, tile3.3, tile3.4)
temp <- merge(Site.1, Site.2, Site.3,  by='Date.Time', all=T)
View(Site.3)
tile3.1 <- read.csv("Data/Tiles3_1_905385_Jan06_Sept06.csv")
tile3.1 <- tile3.1[,c(1:2)]
tile3.2 <- read.csv("Data/Tiles3_2_905382_Sept06_Jan07.csv")
tile3.2 <- tile3.2[,c(1:2)]
tile3.3 <- read.csv("Data/Tiles3_3_905381_Jan07_Sept07.csv")
tile3.3 <- tile3.3[,c(1:2)]
tile3.4 <- read.csv("Data/Tiles3_4_905379_Sept07_Feb08.csv")
tile3.4 <- tile3.4[,c(1:2)]
Site.3 <- rbind(tile3.1, tile3.2, tile3.3, tile3.4)
temp <- merge(Site.1, Site.2, Site.3, by='Date.Time', all=T)
View(Site.1)
View(Site.2)
View(Site.3)
View(temp)
tail(temp)
View(Site.1)
View(Site.2)
View(Site.3)
View(Site.1)
View(temp)
temp <- merge(Site.1, Site.2, Site.3, by='Date/Time', all=T)
tile1.1 <- read.csv("Data/Tiles1_1_905379_Jan06_Sept06.csv")
tile1.1 <- tile1.1[,c(1:2)]
tile1.2 <- read.csv("Data/Tiles1_2_905385_Sept06_Jan07.csv")
tile1.2 <- tile1.2[,c(1:2)]
tile1.3 <- read.csv("Data/Tiles1_3_905383_Jan07_Sept07.csv")
tile1.3 <- tile1.3[,c(1:2)]
tile1.4 <- read.csv("Data/Tiles1_4_905377_Sept07_Feb08.csv")
tile1.4 <- tile1.4[,c(1:2)]
Site.1 <- rbind(tile1.1, tile1.2, tile1.3, tile1.4)
tile2.1 <- read.csv("Data/Tiles2_1_905381_Jan06_Sept06.csv")
tile2.1 <- tile2.1[,c(1:2)]
tile2.2 <- read.csv("Data/Tiles2_2_905384_Jan07_Sept07.csv")
tile2.2 <- tile2.2[,c(1:2)]
Site.2 <- rbind(tile1.1, tile1.2)
tile3.1 <- read.csv("Data/Tiles3_1_905385_Jan06_Sept06.csv")
tile3.1 <- tile3.1[,c(1:2)]
tile3.2 <- read.csv("Data/Tiles3_2_905382_Sept06_Jan07.csv")
tile3.2 <- tile3.2[,c(1:2)]
tile3.3 <- read.csv("Data/Tiles3_3_905381_Jan07_Sept07.csv")
tile3.3 <- tile3.3[,c(1:2)]
tile3.4 <- read.csv("Data/Tiles3_4_905379_Sept07_Feb08.csv")
tile3.4 <- tile3.4[,c(1:2)]
Site.3 <- rbind(tile3.1, tile3.2, tile3.3, tile3.4)
temp <- merge(Site.1, Site.2, Site.3, by='Date.Time', all=T)
View(temp)
View(Site.1)
View(Site.2)
View(Site.3)
View(Site.3)
temp <- merge(Site.1, Site.2,  by='Date.Time', all=T)
View(Site.2)
View(Site.3)
View(Site.2)
View(Site.3)
View(Site.2)
View(Site.3)
str(Site.2)
str(Site.3)
temp <- merge(Site.1, Site.2, Site.3,  by='Date.Time', all=T)
Site.3$Date.Time
tail(Site.3$Date.Time)
class(Site.3$Date.Time)
class(Site.2$Date.Time)
class(Site.1$Date.Time)
dim(Site.1)
dim(Site.2)
dim(Site.3)
temp <- merge(Site.1, Site.2  by='Date.Time', all=T)
temp <- merge(Site.1, Site.2,  by='Date.Time', all=T)
temp <- merge(temp, Site.3,  by='Date.Time', all=T)
tile7.1 <- read.csv("Data/Tiles7_1_905376_Jan06_Sept06.csv")
tile7.1 <- tile7.1[,c(1:2)]
tile7.2 <- read.csv("Data/Tiles7_2_905383_Sept06_Jan07.csv")
tile7.2 <- tile7.2[,c(1:2)]
tile7.3 <- read.csv("Data/Tiles7_3_905377_Jan07_Sept07.csv")
tile7.3 <- tile7.3[,c(1:2)]
tile7.4 <- read.csv("Data/Tiles7_4_905376_Sept07_Feb08.csv")
tile7.4 <- tile7.4[,c(1:2)]
Site.7 <- rbind(tile7.1, tile7.2, tile7.3, tile7.4)
temp <- merge(Site.1, Site.2,  by='Date.Time', all=T)
temp <- merge(temp, Site.3,  by='Date.Time', all=T)
temp <- merge(temp, Site.7,  by='Date.Time', all=T)
tile8.1 <- read.csv("Data/Tiles8_1_905383_Jan06_Sept06.csv")
tile8.1 <- tile8.1[,c(1:2)]
tile8.2 <- read.csv("Data/Tiles8_2_905379_Sept06_Jan07.csv")
tile8.2 <- tile8.2[,c(1:2)]
tile8.3 <- read.csv("Data/Tiles8_3_905385_Sept07_Feb08.csv")
tile8.3 <- tile8.3[,c(1:2)]
Site.8 <- rbind(tile8.1, tile8.2, tile8.3)
tile8.1 <- read.csv("Data/Tiles8_1_905383_Jan06_Sept06.csv")
tile8.1 <- tile8.1[,c(1:2)]
tile8.1 <- read.csv("Data/Tiles8_1_905383_Jan06_Sept06.csv")
tile8.1 <- tile8.1[,c(1:2)]
tile8.2 <- read.csv("Data/Tiles8_2_905379_Sept06_Jan07.csv")
tile8.2 <- tile8.2[,c(1:2)]
tile8.3 <- read.csv("Data/Tiles8_3_905385_Sept07_Feb08.csv")
tile8.3 <- tile8.3[,c(1:2)]
Site.8 <- rbind(tile8.1, tile8.2, tile8.3)
temp <- merge(Site.1, Site.2,  by='Date.Time', all=T)
temp <- merge(temp, Site.3,  by='Date.Time', all=T)
temp <- merge(temp, Site.7,  by='Date.Time', all=T)
temp <- merge(temp, Site.8,  by='Date.Time', all=T)
View(temp)
tile9.1 <- read.csv("Data/Tiles9_1_905384_Jan06_Sept06.csv")
tile9.1 <- tile9.1[,c(1:2)]
tile9.2 <- read.csv("Data/Tiles9_2_905381_Sept06_Jan07.csv")
tile9.2 <- tile9.2[,c(1:2)]
tile9.3 <- read.csv("Data/Tiles9_3_818724_Jan07_Sept07.csv")
tile9.3 <- tile9.3[,c(1:2)]
tile9.4 <- read.csv("Data/Tiles9_4_905378_Sept07_Feb08.csv")
tile9.4 <- tile9.4[,c(1:2)]
Site.9 <- rbind(tile9.1, tile9.2, tile9.3, tile9.4)
Site.9 <- rbind(tile9.1, tile9.2, tile9.3, tile9.4)
View(tile9.1)
View(tile9.2)
View(tile9.1)
View(tile9.2)
View(tile9.3)
View(tile9.4)
tile9.1 <- read.csv("Data/Tiles9_1_905384_Jan06_Sept06.csv")
tile9.1 <- tile9.1[,c(1:2)]
tile9.2 <- read.csv("Data/Tiles9_2_905381_Sept06_Jan07.csv")
tile9.2 <- tile9.2[,c(1:2)]
tile9.3 <- read.csv("Data/Tiles9_3_818724_Jan07_Sept07.csv")
tile9.3 <- tile9.3[,c(1:2)]
tile9.4 <- read.csv("Data/Tiles9_4_905378_Sept07_Feb08.csv")
tile9.4 <- tile9.4[,c(1:2)]
Site.9 <- rbind(tile9.1, tile9.2, tile9.3, tile9.4)
temp <- merge(Site.1, Site.2,  by='Date.Time', all=T)
temp <- merge(temp, Site.3,  by='Date.Time', all=T)
temp <- merge(temp, Site.7,  by='Date.Time', all=T)
temp <- merge(temp, Site.8,  by='Date.Time', all=T)
temp <- merge(temp, Site.9,  by='Date.Time', all=T)
colnames(temp) <- c("Date.Time", "Site.1", "Site.2", "Site.3", "Site.7", "Site.8", "Site.9")
View(temp)
# Plot temperature distributions for each site
par(mfrow=c(2,3), mar=c(3,3,2,2), mgp=c(1.5,0.1,0), tcl=-0.2)
hist(temp$Site.1, xlim=c(26.5,31.5), breaks=20, main="Site 1", xlab="Temp 째C")
hist(temp$Site.2, xlim=c(26.5,31.5), breaks=20, main="Site 2", xlab="Temp 째C")
hist(temp$Site.3, xlim=c(26.5,31.5), breaks=20, main="Site 3", xlab="Temp 째C")
hist(temp$Site.7, xlim=c(26.5,31.5), breaks=20, main="Site 7", xlab="Temp 째C")
hist(temp$Site.8, xlim=c(26.5,31.5), breaks=20, main="Site 8", xlab="Temp 째C")
hist(temp$Site.9, xlim=c(26.5,31.5), breaks=20, main="Site 9", xlab="Temp 째C")
# Calculate summary statistics for each site
temp.summ <- data.frame(mean=apply(temp[,2:7], 2, FUN=mean, na.rm=T),
med=apply(temp[,2:7], 2, FUN=median, na.rm=T),
sd=apply(temp[,2:7], 2, FUN=sd, na.rm=T),
var=apply(temp[,2:7], 2, FUN=var, na.rm=T),
min=apply(temp[,2:7], 2, FUN=min, na.rm=T),
max=apply(temp[,2:7], 2, FUN=max, na.rm=T),
range=apply(temp[,2:7], 2, FUN=function(x) diff(range(x, na.rm=T))),
skew=apply(temp[,2:7], 2, FUN=skewness, na.rm=T),
kurt=apply(temp[,2:7], 2, FUN=function(x) kurtosis(na.omit(x))-3),
hskew=apply(temp[,2:7], 2, FUN=hyperskewness),
hflat=apply(temp[,2:7], 2, FUN=hyperflatness),
dip=apply(temp[,2:7], 2, FUN=function(x) dip(na.omit(x))))
library(moments)
library(diptest)
hyperskewness <- function(x) moment(na.omit(x), order=5, central=T) / sd(na.omit(x))^5
hyperflatness <- function(x) moment(na.omit(x), order=6, central=T) / sd(na.omit(x))^6
# Import temperature data
#temp <- read.csv("Data/Moorea_Temp_Data.csv")
tile1.1 <- read.csv("Data/Tiles1_1_905379_Jan06_Sept06.csv")
tile1.1 <- tile1.1[,c(1:2)]
tile1.2 <- read.csv("Data/Tiles1_2_905385_Sept06_Jan07.csv")
tile1.2 <- tile1.2[,c(1:2)]
tile1.3 <- read.csv("Data/Tiles1_3_905383_Jan07_Sept07.csv")
tile1.3 <- tile1.3[,c(1:2)]
tile1.4 <- read.csv("Data/Tiles1_4_905377_Sept07_Feb08.csv")
tile1.4 <- tile1.4[,c(1:2)]
Site.1 <- rbind(tile1.1, tile1.2, tile1.3, tile1.4)
tile2.1 <- read.csv("Data/Tiles2_1_905381_Jan06_Sept06.csv")
tile2.1 <- tile2.1[,c(1:2)]
tile2.2 <- read.csv("Data/Tiles2_2_905384_Jan07_Sept07.csv")
tile2.2 <- tile2.2[,c(1:2)]
Site.2 <- rbind(tile1.1, tile1.2)
tile3.1 <- read.csv("Data/Tiles3_1_905385_Jan06_Sept06.csv")
tile3.1 <- tile3.1[,c(1:2)]
tile3.2 <- read.csv("Data/Tiles3_2_905382_Sept06_Jan07.csv")
tile3.2 <- tile3.2[,c(1:2)]
tile3.3 <- read.csv("Data/Tiles3_3_905381_Jan07_Sept07.csv")
tile3.3 <- tile3.3[,c(1:2)]
tile3.4 <- read.csv("Data/Tiles3_4_905379_Sept07_Feb08.csv")
tile3.4 <- tile3.4[,c(1:2)]
Site.3 <- rbind(tile3.1, tile3.2, tile3.3, tile3.4)
tile7.1 <- read.csv("Data/Tiles7_1_905376_Jan06_Sept06.csv")
tile7.1 <- tile7.1[,c(1:2)]
tile7.2 <- read.csv("Data/Tiles7_2_905383_Sept06_Jan07.csv")
tile7.2 <- tile7.2[,c(1:2)]
tile7.3 <- read.csv("Data/Tiles7_3_905377_Jan07_Sept07.csv")
tile7.3 <- tile7.3[,c(1:2)]
tile7.4 <- read.csv("Data/Tiles7_4_905376_Sept07_Feb08.csv")
tile7.4 <- tile7.4[,c(1:2)]
Site.7 <- rbind(tile7.1, tile7.2, tile7.3, tile7.4)
tile8.1 <- read.csv("Data/Tiles8_1_905383_Jan06_Sept06.csv")
tile8.1 <- tile8.1[,c(1:2)]
tile8.2 <- read.csv("Data/Tiles8_2_905379_Sept06_Jan07.csv")
tile8.2 <- tile8.2[,c(1:2)]
tile8.3 <- read.csv("Data/Tiles8_3_905385_Sept07_Feb08.csv")
tile8.3 <- tile8.3[,c(1:2)]
Site.8 <- rbind(tile8.1, tile8.2, tile8.3)
tile9.1 <- read.csv("Data/Tiles9_1_905384_Jan06_Sept06.csv")
tile9.1 <- tile9.1[,c(1:2)]
tile9.2 <- read.csv("Data/Tiles9_2_905381_Sept06_Jan07.csv")
tile9.2 <- tile9.2[,c(1:2)]
tile9.3 <- read.csv("Data/Tiles9_3_818724_Jan07_Sept07.csv")
tile9.3 <- tile9.3[,c(1:2)]
tile9.4 <- read.csv("Data/Tiles9_4_905378_Sept07_Feb08.csv")
tile9.4 <- tile9.4[,c(1:2)]
Site.9 <- rbind(tile9.1, tile9.2, tile9.3, tile9.4)
temp <- merge(Site.1, Site.2,  by='Date.Time', all=T)
temp <- merge(temp, Site.3,  by='Date.Time', all=T)
temp <- merge(temp, Site.7,  by='Date.Time', all=T)
temp <- merge(temp, Site.8,  by='Date.Time', all=T)
temp <- merge(temp, Site.9,  by='Date.Time', all=T)
colnames(temp) <- c("Date.Time", "Site.1", "Site.2", "Site.3", "Site.7", "Site.8", "Site.9")
temp$Date.Time <- as.POSIXct(temp$Date.Time, format="%m/%d/%y %T", tz="Pacific/Tahiti")
# Plot temperature distributions for each site
par(mfrow=c(2,3), mar=c(3,3,2,2), mgp=c(1.5,0.1,0), tcl=-0.2)
hist(temp$Site.1, xlim=c(26.5,31.5), breaks=20, main="Site 1", xlab="Temp 째C")
hist(temp$Site.2, xlim=c(26.5,31.5), breaks=20, main="Site 2", xlab="Temp 째C")
hist(temp$Site.3, xlim=c(26.5,31.5), breaks=20, main="Site 3", xlab="Temp 째C")
hist(temp$Site.7, xlim=c(26.5,31.5), breaks=20, main="Site 7", xlab="Temp 째C")
hist(temp$Site.8, xlim=c(26.5,31.5), breaks=20, main="Site 8", xlab="Temp 째C")
hist(temp$Site.9, xlim=c(26.5,31.5), breaks=20, main="Site 9", xlab="Temp 째C")
# Calculate summary statistics for each site
temp.summ <- data.frame(mean=apply(temp[,2:7], 2, FUN=mean, na.rm=T),
med=apply(temp[,2:7], 2, FUN=median, na.rm=T),
sd=apply(temp[,2:7], 2, FUN=sd, na.rm=T),
var=apply(temp[,2:7], 2, FUN=var, na.rm=T),
min=apply(temp[,2:7], 2, FUN=min, na.rm=T),
max=apply(temp[,2:7], 2, FUN=max, na.rm=T),
range=apply(temp[,2:7], 2, FUN=function(x) diff(range(x, na.rm=T))),
skew=apply(temp[,2:7], 2, FUN=skewness, na.rm=T),
kurt=apply(temp[,2:7], 2, FUN=function(x) kurtosis(na.omit(x))-3),
hskew=apply(temp[,2:7], 2, FUN=hyperskewness),
hflat=apply(temp[,2:7], 2, FUN=hyperflatness),
dip=apply(temp[,2:7], 2, FUN=function(x) dip(na.omit(x))))
temp.summ
View(temp.summ)
with(temp.summ, {
par(mar=c(3,4,6,1), mfrow=c(1,1))
plot(NA, xaxt="n", xlim=c(1,6), ylim=c(1,6), xlab="", ylab="Rank Order")
axis(side=1, at=1:6, labels = rownames(temp.summ))
lines(rank(mean), type="b", pch=5, col="gray")
lines(rank(var), type="b", pch=5, col="green")
lines(rank(skew), type="b", pch=2, col="blue")
lines(rank(kurt), type="b", pch=4, col="purple")
lines(rank(hflat), type="b", pch=6, col="black")
lines(rank(dip), type="b", pch=7, col="pink")
legend("top", legend=c("variance", "skewness", "kurtosis", "hyperflatness", "bimodality"),
lty=1, col=c("green", "blue", "purple", "black", "pink"),
pch=c(5,2,4,6,7), inset=c(0,-0.4), xpd=NA)
})
with(temp.summ, {
par(mar=c(3,4,6,1), mfrow=c(1,1))
plot(NA, xaxt="n", xlim=c(1,6), ylim=c(1,6), xlab="", ylab="Rank Order")
axis(side=1, at=1:6, labels = rownames(temp.summ))
lines(rank(mean), type="b", pch=1, col="gray")
lines(rank(var), type="b", pch=5, col="green")
lines(rank(skew), type="b", pch=2, col="blue")
lines(rank(kurt), type="b", pch=4, col="purple")
lines(rank(hflat), type="b", pch=6, col="black")
lines(rank(dip), type="b", pch=7, col="pink")
legend("top", legend=c("mean", "variance", "skewness", "kurtosis", "hyperflatness", "bimodality"),
lty=1, col=c("gray", "green", "blue", "purple", "black", "pink"),
pch=c(5,2,4,6,7), inset=c(0,-0.4), xpd=NA)
})
with(temp.summ, {
par(mar=c(3,4,6,1), mfrow=c(1,1))
plot(NA, xaxt="n", xlim=c(1,6), ylim=c(1,6), xlab="", ylab="Rank Order")
axis(side=1, at=1:6, labels = rownames(temp.summ))
lines(rank(mean), type="b", pch=15, col="gray")
lines(rank(var), type="b", pch=5, col="green")
lines(rank(skew), type="b", pch=2, col="blue")
lines(rank(kurt), type="b", pch=4, col="purple")
lines(rank(hflat), type="b", pch=6, col="black")
lines(rank(dip), type="b", pch=7, col="pink")
legend("top", legend=c("mean", "variance", "skewness", "kurtosis", "hyperflatness", "bimodality"),
lty=1, col=c("gray", "green", "blue", "purple", "black", "pink"),
pch=c(5,2,4,6,7), inset=c(0,-0.4), xpd=NA)
})
with(temp.summ, {
par(mar=c(3,4,6,1), mfrow=c(1,1))
plot(NA, xaxt="n", xlim=c(1,6), ylim=c(1,6), xlab="", ylab="Rank Order")
axis(side=1, at=1:6, labels = rownames(temp.summ))
lines(rank(mean), type="b", pch=15, col="gray")
lines(rank(var), type="b", pch=5, col="green")
lines(rank(skew), type="b", pch=2, col="blue")
lines(rank(kurt), type="b", pch=4, col="purple")
lines(rank(hflat), type="b", pch=6, col="black")
lines(rank(dip), type="b", pch=7, col="pink")
legend("top", legend=c("mean", "variance", "skewness", "kurtosis", "hyperflatness", "bimodality"),
lty=1, col=c("gray", "green", "blue", "purple", "black", "pink"),
pch=c(15,5,2,4,6,7), inset=c(0,-0.4), xpd=NA)
})
plot_heatmap(phy.f.t, "NMDS", "bray", "SampleType", "Family")
plot_heatmap(phy.f.t, "NMDS", "bray")
plot_heatmap(phy.f.t, "NMDS", "bray", "Subtype")
plot_heatmap(phy.f.t, "NMDS", "bray")
plot_richness(phy.f)
?plot_richness
plot_richness(phy.f, "Species")
plot_richness(phy.f, "Species", "Site")
plot_richness(phy.f, "Site", "Species")
plot_tree(phy.f)
plot_bar(phy.f)
plot_richness(phy.f, "Site", "Species")
plot_bar(phy.f)
plot_bar(phy.f, fill=Subtype2)
plot_bar(phy.f, fill="Subtype2")
plot_bar(phy.f, fill="Subtype2", facet_grid = ~Clade)
plot_bar(phy.f, fill="Subtype", facet_grid = ~Clade)
plot_bar(phy.f)
plot_ordination(phy.f, ordinate(phy.f, "MDS"), color = "Site") + geom_point(size = 5)
plot_ordination(phy.f, ordinate(phy.f, "MDS"), color = "Site")
plot_ordination(phy.f, ordinate(phy.f, "MDS"), color = "Species")
---
title: "Moorea *Symbiodinium* data exploration"
author: "Ross Cunning"
date: "November 18, 2016"
output: html_document
---
```{r load}
library(phyloseq)
taxcolors <- matrix(c("#8dd3c7", "#bebada", "#fb8072"),
dimnames=list(c("CladeA", "CladeC", "CladeD")))
options(stringsAsFactors = FALSE)
load("Data/Moorea_sym.RData")  # loads phyloseq object named phy.f
head(phy.f)
phy.f
tax_table(phy.f)
ordinate(phy.f, "NMDS", "bray",try=100)
ordinate(phy.f.t, "NMDS", "bray",try=100)
phy.f.t
plot_bar(phy.f)
x -> read.csv("/Users/hputnam/MyProjects/Moorea_Sym/Bioinf/clust/97_otus_bysample.tsv")
x -> read.csv("/Users/hputnam/MyProjects/Moorea_Sym/Bioinf/clust/97_otus_bysample.tsv", header=T, sep="")
x <- read.csv("/Users/hputnam/MyProjects/Moorea_Sym/Bioinf/clust/97_otus_bysample.tsv", header=T, sep="")
x <- read.csv("/Users/hputnam/MyProjects/Moorea_Sym/Bioinf/clust/97_otus_bysample.tsv", header=T, sep=" ")
View(x)
x <- read.csv("/Users/hputnam/MyProjects/Moorea_Sym/Bioinf/clust/97_otus_bysample.tsv", header=T)
x <- read.table("/Users/hputnam/MyProjects/Moorea_Sym/Bioinf/clust/97_otus_bysample.tsv", sep="\t", header=TRUE)
View(x)
x <- read.table("/Users/hputnam/MyProjects/Moorea_Sym/Bioinf/clust/97_otus_bysample.tsv", sep="\t", header=F)
?read.table
x <- read.table("/Users/hputnam/MyProjects/Moorea_Sym/Bioinf/clust/97_otus_bysample.tsv", sep="\t", header=F, ncols=-1)
x <- x[,-1]
x <- x/rowSums(x)
x
rowSums(x)
d <- dist(x)
d
d <- dist(t(x))
d
dim(d)
class(d)
vegdist(t(x),method="bray")
library(vegan)
vegdist(t(x),method="bray")
metaMDS(d)
d
library(vegdist)
x <- read.table("/Users/hputnam/MyProjects/Moorea_Sym/Bioinf/clust/97_otus_bysample.tsv", sep="\t", header=F)
x < x[,-1]
library(vegan)
x <- read.table("/Users/hputnam/MyProjects/Moorea_Sym/Bioinf/clust/97_otus_bysample.tsv", sep="\t", header=F)
x < x[,-1]
View(x)
x[,-1]
x <- x[,-1]
d <- vegdist(t(x),method="bray")
d
View(x)
rel.x <- as.matrix(t(x))
rel.x <- x/rowSums(x)
rowSums(x)
library(vegan)
x <- read.table("/Users/hputnam/MyProjects/Moorea_Sym/Bioinf/clust/97_otus_bysample.tsv", sep="\t", header=F)
x <- x[,-1]
rel.x <- as.matrix(t(x))
rel.x <- x/colSums(x)
colSums(x)
library(vegan)
x <- read.table("/Users/hputnam/MyProjects/Moorea_Sym/Bioinf/clust/97_otus_bysample.tsv", sep="\t", header=F)
x <- x[,-1]
rel.x <- x/rowSums(x)
rowSums(rel.x)
rel.x <- as.matrix(t(x))
d <- vegdist(x,method="bray")
d
rel.x
library(vegan)
x <- read.table("/Users/hputnam/MyProjects/Moorea_Sym/Bioinf/clust/97_otus_bysample.tsv", sep="\t", header=F)
x <- x[,-1]
rel.x <- x/rowSums(x)
rel.x
View(rel.x)
